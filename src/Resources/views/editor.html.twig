{#
    Gravity UI Markdown Editor - Twig template.
    Requires JS build (npm run build) and assets:install.
    Editor runs in iframe to isolate React from parent DOM (avoids setValue conflicts).
    Config passed via data attributes to avoid script escaping issues.
#}
{% set _gmd_cfg = gravity_markdown_editor_config() %}
{% set _gmd_cfg = _gmd_cfg|merge({
    editor: (_gmd_cfg.editor|default({}))|merge(editor_options|default({})),
    view: (_gmd_cfg.view|default({}))|merge(view_options|default({})),
    lang: lang|default(_gmd_cfg.lang|default('en')),
    initial: (_gmd_cfg.initial|default({}))|merge({markup: value|default('')})
}) %}
<div class="gravity-markdown-editor-wrapper" id="{{ id }}-wrapper" data-gravity-editor="true"
     data-gravity-cfg="{{ _gmd_cfg|json_encode|e('html_attr') }}"
     data-gravity-frame="{{ asset('bundles/attuladzanmarkdowneditor/build/editor-frame.html')|e('html_attr') }}"
     data-gravity-textarea-id="{{ id|e('html_attr') }}">
    <textarea name="{{ name }}" id="{{ id }}" class="gravity-markdown-editor-textarea" rows="10"
              style="position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden;"
              aria-hidden="true" tabindex="-1">{{ value }}</textarea>
    <div id="{{ id }}-mount" class="gravity-markdown-editor-mount" style="min-height:520px;"></div>
</div>
<script src="{{ asset('bundles/attuladzanmarkdowneditor/build/gravity-editor-init.js') }}"></script>
